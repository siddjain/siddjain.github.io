<!-- from https://github.com/jekyll/minima/blob/master/_layouts/default.html -->
<!DOCTYPE html>
<html lang="en"><!-- this file derived from https://github.com/jekyll/minima/blob/v2.0.0/_includes/head.html
     and has following changes:
     - it adds custom-head.html to the original file
     - it adds  page.description to the meta description tag which helps in SEO -->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Understanding how quantum annealing can be used to solve the QUBO problem</title>
  <meta name="description" content="understand the math behind how quantum annealing can be used to solve the QUBO problem">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://siddjain.github.io/2021/08/05/how_quantum_annealing_works.html">
  <link rel="alternate" type="application/rss+xml" title="siddharth&#39;s space" href="/feed.xml">
  
  <!-- this file overrides https://github.com/jekyll/minima/blob/master/_includes/custom-head.html -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head><body>
    
    <!-- from https://developers.facebook.com/docs/plugins/like-button/ -->
    <!-- I created a new app to get the appID. https://developers.facebook.com/apps/194621285460565/add/ -->
    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous"
     src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v9.0&appId=194621285460565&autoLogAppEvents=1"
     nonce="mY2hWZoA"></script><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">siddharth&#39;s space</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <!-- this file is derived from https://github.com/jekyll/minima/blob/master/_layouts/post.html
    and modifies the original to add the FB like button to the post -->
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Understanding how quantum annealing can be used to solve the QUBO problem</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-08-05T08:00:00+00:00" itemprop="datePublished">
        Aug 5, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Siddharth Jain</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div class="sect1">
<h2 id="preface-defining-the-problem">Preface: defining the problem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Recently I had a chance to try out D-Wave&#8217;s quantum computer. Reading their documentation, it seems this device can only do one thing which is to find the \(x\)
that minimizes \(x^T Q x\) where \(x\) is a \(n\) length vector of \(0\)s and \(1\)s and \(Q\) is a symmetrical \(n \times n\) matrix. This problem is
also known as Quadratic Unconstrained Binary Optimization or <a href="https://en.wikipedia.org/wiki/Quadratic_unconstrained_binary_optimization">QUBO</a>. Ok, no problem.</p>
</div>
<div class="paragraph">
<p>Then I read that this device uses (and works by doing) <a href="https://en.wikipedia.org/wiki/Quantum_annealing">quantum annealing</a> (QA). Now the problem:</p>
</div>
<div class="paragraph">
<p><em>I can find no book or reference showing that how these two things are related. How will doing QA solve a QUBO?</em></p>
</div>
<div class="paragraph">
<p>Wikipedia&#8217;s page on QA says:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The transverse field is finally switched off, and the system is expected to have reached the ground state of the classical Ising model that corresponds to the solution to the original optimization problem</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><em>But how? where is the proof?</em> QM tells us that the ground-state is given by the eigenvector corresponding to lowest eigenvalue of the Hamiltonian \(H\).
How is finding the minimum of \(x^T Q x\) (<strong>P1</strong>) equivalent to finding the (lowest eigenvalued) eigenvector of a matrix \(H\) (<strong>P2</strong>)? And if so,
what is relation between \(Q\) and \(H\)? If <strong>P1</strong> and <strong>P2</strong> were same how come books on quadratic programming or <a href="https://en.wikipedia.org/wiki/Quadratic_programming">wikipedia</a>
make no note of it?</p>
</div>
<div class="paragraph">
<p>I actually asked this on <a href="https://quantumcomputing.stackexchange.com/questions/19654/how-is-eigendecomposition-of-a-hamiltonian-equivalent-to-finding-the-minimum-of">Stack Overflow</a>
to which the response (answer) was that consider \(Q = H\) and a proof minimizing \(x^T H x\) copied below under terms of CC BY-SA license:</p>
</div>
<hr>
<div class="imageblock">
<div class="content">
<img src="/assets/images/so_answer_to_qubo_question.png" alt="so answer to qubo question">
</div>
</div>
<hr>
<div class="paragraph">
<p>There are many problems with this answer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The \(x\) in \(\langle x | H | x \rangle\) is a unit-length vector but the \(x\) in QUBO is not a unit-length
vector. Its length can be \(0\) or more than \(1\).</p>
</li>
<li>
<p>The \(x\) in the answer is a vector of <em>continuous</em> complex variables whereas the \(x\) in QUBO contains only \(0\)s and \(1\)s.</p>
</li>
<li>
<p>The \(x\) in the answer is the wave function and so its length is actually \(2^n\)! Similarly, shouldn&#8217;t the Hamiltonian \(H\) be a \(2^n \times 2^n\) matrix whereas
\(Q\) is \(n \times n\)?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In other words, the answer is unfortunately completely incorrect (no offense to the person who answered it). When I tried to point out these things, Stack Overflow users (many of them
with \(&gt;10\)k reputation I believe) ironically downvoted my question and even voted to close it. The question kept bothering me though.
The best I could grasp is that we use QA to minimize \(\langle \Psi | H | \Psi \rangle\) for some \(H\) - what \(H\) is continued to be unclear - make an observation
(measurement) and map the result to the \(x\) of the original QUBO problem. But how does that minimize \(x^T Q x\) is completely unclear and voodoo until finally I got it one
morning as I was getting ready to go to work&#8230;&#8203;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-it-works">How it works</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Ising Hamiltonian \(H\) can be seen in books or papers as defined like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/images/ising_hamiltonian.png" alt="ising hamiltonian">
</div>
</div>
<div class="paragraph">
<p>The term we need to concern ourselves with is the final Hamiltonian:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/images/ising_final_hamiltonian.png" alt="ising final hamiltonian">
</div>
</div>
<div class="paragraph">
<p>What the heck does \(\sigma_i^z\) even mean? No book will tell you that. That is why we need to go to a school
where we can ask questions to a real professor. The only place where I could find an explanation was <a href="https://arxiv.org/abs/0804.4884">this</a>
paper (which I found as I was writing this article and after having worked it out myself) where he explains that:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/images/ising_hamiltonian_explained.png" alt="ising hamiltonian explained">
</div>
</div>
<div class="paragraph">
<p>taking an example \(n=3\), what the equation is saying is really this:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\begin{split}
H &amp; = h_1 Z \otimes I \otimes I \\
  &amp; + h_2 I \otimes Z \otimes I \\
  &amp; + h_3 I \otimes I \otimes Z \\
  &amp; + J_{12} Z \otimes Z \otimes I \\
  &amp; + J_{13} Z \otimes I \otimes Z \\
  &amp; + J_{23} I \otimes Z \otimes Z \\
\end{split}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>where I use \(Z\) for the \(2 \times 2\) Pauli \(\sigma^z\) matrix. We can see that \(H\) is a \(2^3 \times 2^3\) matrix.
What are the eigenvalues of \(H\)? The eigenvalues of \(Z\) are \(\{-1, +1\}\) and \(I\) has only one eigenvalue namely \(1\).
We use following three properties which play a key role:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Property 1</strong> The eigenvalues of tensor product of matrices are equal to product of constituent eigenvalues i.e.</p>
</li>
</ul>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\textrm{eig}(A \otimes B) = \textrm{eig}(A) \times \textrm{eig}(B)
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>refer some book on Linear Algebra if you need. The other key fact is this</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Property 2</strong> If \(A\) and \(B\) are two matrices and \(C\) is the sum of \(A\) and \(B\), then in general
the eigenvalues of \(C\) are not equal to the sum of eigenvalues of \(A\) and \(B\), but if \(A\) and \(B\)
have the same eigenvectors, then the eigenvalues do add up! In that case:</p>
</li>
</ul>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\textrm{eig}(A + B) = \textrm{eig}(A) + \textrm{eig}(B) \textrm{if A and B have same eigenvectors}
\end{equation}\]
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Property 3</strong> The eigenvectors of tensor product of matrices are equal to tensor product of constituent eigenvectors i.e.</p>
</li>
</ul>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\textrm{eigvec}(A \otimes B) = \textrm{eigvec}(A) \otimes \textrm{eigvec}(B)
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>this is related to Property 1 and same proof applies.</p>
</div>
<div class="paragraph">
<p>Now the eigenvectors of \(Z\) are \((1,0)^T\) and \((0,1)^T\). Any vector \(v\) is an eigenvector of \(I\)
but to choose a basis, we choose the same eigenvectors \((1,0)^T\) and \((0,1)^T\) for \(I\) as well.
With this we can show that the \(2^3\) eigenvalues (allowed energy levels) of \(H\) are in fact given by:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\begin{split}
E &amp; = h_1 s_1 + h_2 s_2 + h_3 s_3 + J_{12} s_1 s_2 + J_{13} s_1 s_3 + J_{23} s_2 s_3
\end{split}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>where \(s_1, s_2, s_3\) are binary variables taking on values \(\{-1, +1\}\) (the eigenvalues of \(Z\)).
E.g., the combination \((-1,+1,-1)\) of \((s_1, s_2, s_3)\) gives one possible value of \(E\).
This is nothing but the QUBO cost function. The ground-state is the state that minimizes \(E\)
and if we measure the values of the spins (qubits) in the ground state (measurement of a qubit will yield \(-1\) or \(+1\))
we will find the vector \(x\) that minimizes the QUBO cost function. So this is how it works.
If you do the math, it turns out the (final) Ising Hamiltonian is actually a diagonal matrix containing the energy values \(E\) on its diagonal.
All the off-diagonal elements are \(0\).</p>
</div>
<div class="paragraph">
<p>This also explains why the D-Wave computer is a special purpose computer because its Hamiltonian is constrained to be an Ising Hamiltonian
in a transverse field.</p>
</div>
</div>
</div>
  </div>

  <!-- from https://developers.facebook.com/docs/plugins/like-button/ -->
  <!-- page.url will give the URL of the page sans the domain name. refer https://jekyllrb.com/docs/variables/ -->
  <!-- more at https://www.digitalocean.com/community/tutorials/how-to-control-urls-and-links-in-jekyll -->
  <div class="fb-like" data-href="https://siddjain.github.io/2021/08/05/how_quantum_annealing_works.html" 
      data-width="" 
      data-layout="standard"
      data-action="like" 
      data-size="small"
      data-share="true"></div><a class="u-url" href="/2021/08/05/how_quantum_annealing_works.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">siddharth&#39;s space</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">siddharth&#39;s space</li><li><a class="u-email" href="mailto:siddjain@example.com">siddjain@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/siddjain"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">siddjain</span></a></li><li><a href="https://www.twitter.com/fd97207"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">fd97207</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>कोशिश करने वालो की कभी हार नहीं होती…</p>
      </div>
    </div>

  </div>

</footer>
<!-- refer https://github.com/asciidoctor/jekyll-asciidoc#adding-the-stem-assets-to-the-page --><!-- from https://github.com/asciidoctor/jekyll-asciidoc#adding-the-stem-assets-to-the-page -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    messageStyle: "none",
    tex2jax: {
        inlineMath: [["\\(", "\\)"]],
        displayMath: [["\\[", "\\]"]],
        ignoreClass: "nostem|nolatexmath"
    },
    asciimath2jax: {
        delimiters: [["\\$", "\\$"]],
        ignoreClass: "nostem|noasciimath"
    },
    TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script></body>

</html>